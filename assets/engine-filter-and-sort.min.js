(()=>{var e={845:e=>{self,e.exports=(()=>{"use strict";var e={};return((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isArmadaLoaded=void 0,t.isArmadaLoaded=e=>{var t,a;const r=!0===(null===(a=null===(t=window.eight)||void 0===t?void 0:t.armada)||void 0===a?void 0:a.loaded);if(!e)return r;r?e():document.addEventListener("ARMADA:LOADED",e)},t.default=t.isArmadaLoaded})(0,e),e})()}},t={};function a(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,a),s.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=a(845);class t extends HTMLElement{constructor(){super(),this.filterPosition=this.getAttribute("filter-position"),this.searchParamsInitial=window.location.search.slice(1),this.searchParamsPrev=window.location.search.slice(1),this.sectionId=this.getAttribute("section-id"),this.onActiveFilterClick=this.onActiveFilterClick.bind(this),this.activeFacetCountContainer=document.querySelector('[data-armada-selector="active-facet-count"]'),this.isSidebarForm=this.classList.contains("sidebar-form"),this.isSearchPage()?this.gridSelector=document.querySelector('[data-armada-selector="search-grid-main"]'):this.gridSelector=document.querySelector('[data-armada-selector="collection-grid-main"]');this.debouncedOnSubmit=((e,t=500)=>{let a;return(...r)=>{clearTimeout(a),a=setTimeout((()=>{e.apply(this,r)}),t)}})((e=>{this.onSubmitHandler(e)}),500)}connectedCallback(){if(!this.gridSelector||!this.querySelector("form"))return;this.querySelectorAll("form details").forEach((e=>{e.addEventListener("toggle",this.handleDetailToggle)})),this.querySelector("form").addEventListener("change",this.debouncedOnSubmit.bind(this)),this.setListeners(),window.Shopify.designMode&&"sidebar"!==this.filterPosition&&this.removeTopbarContainer(),"sidebar"==this.filterPosition&&this.isSidebarForm&&this.addTopbarContainer(),(0,e.isArmadaLoaded)(this.registerElement)}registerElement(){window.eight.armada.elementRegistry.register({key:"filter-and-sort",assetPath:"/assets/engine-filter-and-sort.min.js"})}setListeners(){if(!this.isSearchPage()){const e=e=>{const t=e.state?e.state.searchParams:this.searchParamsInitial;t!==this.searchParamsPrev&&this.renderPage(t,null,!1)};window.addEventListener("popstate",e)}this.handleApplyBtn(this.isMobile()),window.addEventListener("resize",(()=>this.handleApplyBtn(this.isMobile())))}handleApplyBtn(e){if(this.topbarForm=document.querySelector('[data-armada-selector="filter-topbar-form"]'),this.applyFilterBtn=this.topbarForm.querySelector('[data-armada-selector="apply-filters"]'),this.currentModal=this.topbarForm.closest('armada-modal[data-modal-id="filter-modal-trigger"]'),!(this.applyFilterBtn&&e&&this.topbarForm&&this.currentModal))return;const t=this.currentModal.querySelector('[data-armada-selector="modal-container"]'),a=this.topbarForm.querySelector('[data-armada-selector="filter_button_wrapper"]'),r=this.topbarForm.querySelector('[data-armada-selector="filter_button_container"]');new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(r)if(e.isIntersecting)r.classList.remove("!fixed"),r.removeAttribute("style"),this.applyFilterBtn.classList.add("mb-l");else{const e=document.querySelector('[data-armada-selector="filter-topbar-form"]'),t=e.closest('[data-armada-selector="modal-inner"]').getBoundingClientRect(),a=e.getBoundingClientRect();r.classList.add("!fixed"),r.style.width=`${a.width}px`,r.style.maxWidth="100%",r.style.padding="16px 40px",r.style.top=t.top-1+"px",r.style.left=`${a.left}px`,r.style.zIndex="300",this.applyFilterBtn.classList.remove("mb-l")}}))}),{root:t,rootMargin:"0px",threshold:0}).observe(a),this.applyFilterBtn.addEventListener("click",(()=>window.eight.eventsEngine.emit(`${eight.constants.events["ARMADA:MODAL:CLOSE:ALL"]}`)))}addTopbarContainer(){this.removeTopbarContainer();const e=document.querySelector('[data-armada-selector="section-collection-filters"]')||document.querySelector('[data-armada-selector="section-search-filters"]'),t=document.querySelector('[data-armada-selector="collection-top-bar-facets"]')||document.querySelector('[data-armada-selector="search-top-bar-facets"]');if(!e||!t)return;const a=document.createElement("div");a.setAttribute("class","w-full"),a.classList.add("lg:min-h-[24px]","lg:px-2xl","bg-page"),a.setAttribute("data-armada-selector","sidebar_facets"),a.innerHTML=t.outerHTML,a.firstChild.classList.add("lg:grid");const r=e.dataset.sectionId,i=document.querySelector(`#shopify-section-${r}`);i.parentElement.insertBefore(a,i)}removeTopbarContainer(){const e=document.querySelector('[data-armada-selector="sidebar_facets"]');e&&e.remove()}handleDetailToggle(){if(this.open){this.closest("form").querySelectorAll("details[open]").forEach((e=>{e!==this&&(e.open=!1)}))}}onSubmitHandler(e){e.preventDefault(),this.productCardWrapper=this.gridSelector.querySelector('[data-armada-selector="collection-card-grid"]'),this.activeFacetContainer=this.querySelector('[data-armada-selector="active_facet_container"]'),this.loadingState=this.querySelector('[data-armada-selector="facets-loading"]'),this.productCardWrapper&&this.productCardWrapper.classList.add("animate-pulse"),this.activeFacetContainer&&this.activeFacetContainer.classList.add("animate-pulse"),this.loadingState&&!this.activeFacetContainer&&this.loadingState.classList.remove("hidden");const t=new FormData(e.target.closest("form")),a=new URLSearchParams(t).toString();this.isSearchPage()?this.renderPage(a,e,!1):this.renderPage(a,e)}renderPage(e,t,a=!0){this.searchParamsPrev=e;this.getSections().forEach((a=>{const r=`${window.location.pathname}?section_id=${a.section}&${e}`;this.renderSectionFromFetch(r,t)})),a&&this.updateURL(e)}renderSectionFromFetch(e){let t,a,r;if(this.isSearchPage()){const e=document.querySelector('[data-armada-selector="search-grid-main"]').dataset.sectionId,i=document.querySelector('[data-armada-selector="section-search-filters"]').dataset.sectionId;if(!e)return;t=[i,e],a=[document.querySelector('[data-armada-selector="search-grid-main"]')],r=['[data-armada-selector="search-grid-main"]']}else{const e=document.querySelector('[data-armada-selector="collection-grid-main"]').dataset.sectionId,i=document.querySelector('[data-armada-selector="section-collection-filters"]').dataset.sectionId;if(!e)return;t=[i,e],a=[document.querySelector('[data-armada-selector="collection-grid-main"]')],r=['[data-armada-selector="collection-grid-main"]']}window.eight.sectionsEngine.sectionRenderingEngine.fetchSection(e,t,a,r,(e=>{if(!e)return;const t=document.querySelectorAll('[data-armada-selector="filter-main-form"]'),a=document.querySelector('[data-armada-selector="active-facet-count"]'),r='[data-armada-selector="filter-main-form"] .active-facets',i="[data-armada-selected-filters-count]",s='[data-armada-selector="filter_input_list"]',o=new RegExp(/data-armada-facet-count="([^"]*?)"/g),n=e[0].match(o),c=new RegExp(/data-armada-filter-form="([^"]*?)"/g),l=e[0].match(c);if(n){const e=n[0].replace(/data-armada-facet-count=\"/g,"").replace(/\"/g,"");a&&(a.textContent=e)}if(l){let e=[];l.map((function(t){const a=t.replace(/data-armada-filter-form=\"/g,"").replace(/\"/g,"");e.push(a)})),t.length&&t.forEach(((t,a)=>{const o=document.createElement("div");o.innerHTML=e[a];const n=document.createElement("div");n.innerHTML=o.textContent;const c=n.querySelector(`${r}`);let l=t.querySelector(`${r}`),d=document.querySelector('[data-armada-selector="sidebar_facets"] .active-facets');c&&l&&(l.innerHTML=c.innerHTML),d&&c&&(d.innerHTML=c.innerHTML);const h=n.querySelectorAll(`${i}`);t.querySelectorAll(`${i}`).forEach(((e,t)=>{e.textContent=h[t].textContent}));const m=n.querySelectorAll(`${s}`);t.querySelectorAll(`${s}`).forEach(((e,t)=>{e.innerHTML=m[t].innerHTML}))}))}this.productCardWrapper=this.gridSelector.querySelector('[data-armada-selector="collection-card-grid"]'),this.activeFacetContainer=this.querySelector('[data-armada-selector="active_facet_container"]'),this.loadingState=this.querySelector('[data-armada-selector="facets-loading"]'),this.productCardWrapper&&(this.productCardWrapper.classList.remove("animate-pulse"),window.eight.eventsEngine.namedEvents.animate(this.productCardWrapper)),this.activeFacetContainer&&this.activeFacetContainer.classList.remove("animate-pulse"),this.loadingState&&!this.loadingState.classList.contains("hidden")&&this.loadingState.classList.add("hidden")}))}updateURL(e){history.pushState({searchParams:e},"",`${window.location.pathname}${e&&"?".concat(e)}`)}onActiveFilterClick(e){e.preventDefault();const t=-1==e.currentTarget.href.indexOf("?")?"":e.currentTarget.href.slice(e.currentTarget.href.indexOf("?")+1);this.productCardWrapper=this.gridSelector.querySelector('[data-armada-selector="collection-card-grid"]'),this.activeFacetContainer=this.querySelector('[data-armada-selector="active_facet_container"]'),this.loadingState=this.querySelector('[data-armada-selector="facets-loading"]'),this.productCardWrapper&&this.productCardWrapper.classList.add("animate-pulse"),this.activeFacetContainer&&this.activeFacetContainer.classList.add("animate-pulse"),this.loadingState&&!this.activeFacetContainer&&this.loadingState.classList.remove("hidden"),this.renderPage(t)}getSections(){return[{section:document.querySelector("collection-grid").dataset.sectionId}]}isMobile(){return window.matchMedia("only screen and (max-width: 1023px)").matches}isSearchPage(){return"true"==this.dataset.searchPage}}class r extends HTMLElement{constructor(){super(),this.filterForm=this.closest("facet-filter-form")||document.querySelector("facet-filter-form"),this.clearAllBtn=this.querySelector('[data-armada-selector="filters_clear_all"]'),this.isPriceFilter=!!this.dataset.priceFilterActive,this.priceFilterMax=this.filterForm.querySelector('[data-armada-selector="filter_price_to"]'),this.priceFilterMin=this.filterForm.querySelector('[data-armada-selector="filter_price_from"]'),this.filterForm&&(this.filterPosition=this.filterForm.getAttribute("filter-position"))}connectedCallback(){this.querySelector("a").addEventListener("click",(e=>{e.preventDefault(),this.isPriceFilter&&this.clearPriceFilterInputs();(e.target.closest("facet-filter-form")||document.querySelector("facet-filter-form")).onActiveFilterClick(e)})),this.clearAllBtn&&this.clearAllBtn.addEventListener("click",(()=>{window.eight.eventsEngine.emit(`${eight.constants.events["ARMADA:MODAL:CLOSE:ALL"]}`),this.clearPriceFilterInputs()}))}clearPriceFilterInputs(){(this.priceFilterMin||this.priceFilterMax)&&(this.priceFilterMax.value="",this.priceFilterMin.value="")}isMobile(){return window.matchMedia("only screen and (max-width: 1023px)").matches}}class i extends HTMLElement{constructor(){super(),this.querySelectorAll("input").forEach((e=>e.addEventListener("change",this.onRangeChange.bind(this))))}onRangeChange(e){this.adjustToValidValues(e.currentTarget),this.setMinAndMaxValues()}setMinAndMaxValues(){const e=this.querySelector('[data-armada-selector="filter_price_from"]'),t=this.querySelector('[data-armada-selector="filter_price_to"]');t.value&&e.setAttribute("max",t.value),e.value&&t.setAttribute("min",e.value),""===e.value&&t.setAttribute("min",0),""===t.value&&e.setAttribute("max",t.getAttribute("max"))}adjustToValidValues(e){const t=Number(e.value),a=Number(e.getAttribute("min")),r=Number(e.getAttribute("max"));t<a&&(e.value=a),t>r&&(e.value=r)}}class s extends HTMLElement{constructor(){super(),this.hiddenSortInputs=document.querySelectorAll('facet-filter-form [data-armada-selector="sort_by_value"]'),this.sortByForm=this.querySelector('[data-armada-selector="sort_by_form"]'),this.filterForms=document.querySelectorAll("facet-filter-form form")}connectedCallback(){this.init()}init(){if(this.hiddenSortInputs.length){const e=new Event("change");this.sortByForm.addEventListener("change",(()=>{this.hiddenSortInputs.forEach((e=>{e.value=this.sortByForm.querySelector("input:checked").value})),this.filterForms.length&&this.filterForms.forEach((t=>t.dispatchEvent(e)))}))}}}customElements.define("price-range",i),customElements.define("facet-remove",r),customElements.define("facet-filter-form",t),customElements.define("sort-form",s)})()})();