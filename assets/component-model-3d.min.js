(()=>{class e extends HTMLElement{constructor(){super(),this.button}connectedCallback(){this.button.addEventListener("click",this.loadModel.bind(this))}async loadModel(){this.setPadding(),this.pauseAll(),this.getAttribute("loaded")||(await this.moveModelIntoDOM(),this.setAttribute("loaded",!0),this.loadViewerUI())}loadViewerUI(){window.Shopify.loadFeatures([{name:"model-viewer-ui",version:"1.0"}],function(){this.controller=new Shopify.ModelViewerUI(this.querySelector("model-viewer")),this.controller.viewer.parentElement.addEventListener("mouseup",function(e){e.stopPropagation=function(){}}.bind(this),{capture:!0}),this.controller.elements.controlButton.addEventListener("click",function(e){e.stopImmediatePropagation()}.bind(this),{capture:!0}),window.ProductModel.loadShopifyXR()}.bind(this))}async moveModelIntoDOM(){const e=document.createElement("div");e.appendChild(this.querySelector("template").content.firstElementChild.cloneNode(!0));const t=e.querySelector("model-viewer");this.appendChild(t),this.querySelector("model-viewer")?.focus()}setPadding(){const e=this.getBoundingClientRect(),t=1/(e.width/e.height)*100+"%";this.style.paddingTop=t}pauseAll(){document.querySelectorAll("model-viewer").forEach((e=>{e.modelViewerUI&&modelViewerUI.pause()}))}disconnectedCallback(){this.button.removeEventListener("click",this.loadModel)}get button(){return this.querySelector('button[data-action="play"]')}}window.ProductModel={loadShopifyXR(){Shopify.loadFeatures([{name:"shopify-xr",version:"1.0",onLoad:this.setupShopifyXR.bind(this)}])},setupShopifyXR(e){e||(window.ShopifyXR?(document.querySelectorAll('[id^="productModelJSON-"]').forEach((e=>{window.ShopifyXR.addModels(window.eight.safeJSONParse(e.textContent)),e.remove()})),window.ShopifyXR.setupXRElements()):document.addEventListener("shopify_xr_initialized",(()=>this.setupShopifyXR())))}},window.customElements.define("model-3d",e)})();